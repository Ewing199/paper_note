# 1.网络层:IP（网际协议）
### 1.1 ARP
*请求得知目标ip的物理地址*
在ARP高速缓存里放入一个IP地址到硬件地址的映射表，并为每个项目都设置生存时间：找到物理地址则写入ARP缓存以便快速通讯，找不到则将路由器IP地址解析为硬件地址，由路由器继续转发

## 1.2 IP报文的格式
1. 协议版本：4位，**IPV4:4，IPV6:6**
2. 首部长度：4位 **最大为60字节，为4字节的证书倍，固定长度20字节，最大60字节等**
3. 区分服务：8位 ，**一般未使用**
4. 总长度：16位，**首部长度+数据长度(不超过数据链路层规定的最大传送单元--MTU)**
5. 标识：16，**产生一个数据报，计数+1，数据报超度超过MTU的长度需要分片时，该字段被复制到所有分片中，即同一数据包的标识相同**
6. 标志：3，**最低位MF：0(没有分片)，1(还有分片)；中间位DF：0(允许分片)，1(不允许分片)**
7. 片偏移：13，**片在分组中的相对位置，便宜为8的整数倍，```offset = lenth(前片的数据长度)/8```**
8. 生存时间：8,**数据报在网络中的寿命，由原来的秒数已改为路由跳数限制**
9. 协议：8，**报文的协议，如ICMP，IGMP，TCP等等**
10. 首部检验和：16，**校验首部部分，每经过一次路由器，某些字段都会发生变化，计算方法```16位字为一段，检验和先置零，进行反码求和(按位相加，最高位进位结果+1），再取反码```**
11. 源地址：32
12. 目的地址：32

## 1.3 路由转发
**（目的IP地址，下一跳地址）**
发送
> 分组转发算法：
1.提取目的Ip 地址D，计算网络地址N
2.N直接与当前路由器相连，**直接交付**
